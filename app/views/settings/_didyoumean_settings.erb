<fieldset>
  <p><%=l(:dym_settings_search_method)%></p>
  <p>
    <label><%= l(:dym_select_searching_method)%></label>
    <%= select_tag 'settings[search_method]', options_for_select({
                l(:dym_sql) => "0",
                l(:dym_thinking_sphinx) => "1",
                l(:dym_elastic_search) => "2"
                }, @settings['search_method'])
    %>
    <em class="info" id="sql_info"><%= l(:dym_search_by_sql_info)%></em>
    <em class="info" id="ts_info">
      <%= l(:dym_thinking_sphinx_info)%><br />
      <%= l(:dym_search_by_ts_info)%><br />
      <%= l(:dym_search_difference)%>
    </em>
    <em class="info" id="es_info">
      <%= l(:dym_search_by_elastic_info)%><br/>
      <%= l(:dym_elastic_proxy)%>
    </em>
  </p>
  <p id="elastic_lang">
    <label><%= l(:dym_select_searching_language)%></label>
    <%= select_tag 'settings[search_language]', options_for_select(YAML.load_file(Rails.root.join('plugins/redmine_didyoumean/config/languages.yml')), @settings['search_language'])
    %>
    <em class="info" id="select_lang_note"><%= l(:dym_select_searching_language_info) %></em>
  </p>
  <hr />
  <p><%= l(:dym_settings) %></p>
  <p>
    <label><%= l(:dym_show_only_open_label)%></label>
    <%= select_tag 'settings[show_only_open]', options_for_select({
                l(:dym_only_open) => "1",
                l(:dym_all_statuses) => "0"
                }, @settings['show_only_open'])
    %>
  </p>
  <p>
    <label><%= l(:dym_project_filter_label)%></label>
    <%= select_tag 'settings[project_filter]', options_for_select({
                l(:dym_just_current) => "0",
                l(:dym_current_and_children) => "1",
                l(:dym_any_project) => "2",
                l(:dym_parent) => "3",
                }, @settings['project_filter'])
    %>
  </p>
  <p>
    <label><%= l(:dym_min_word_length_label)%></label>
    <%= text_field_tag('settings[min_word_length]',
                       @settings['min_word_length'],
                       :type => 'number')
    %>
  </p>
  <p>
    <label><%= l(:dym_limit) %></label>
    <%= val = @settings[:limit]
        val = 5 if @settings[:limit].nil? or @settings[:limit].empty?
        text_field_tag("settings[limit]", val) %>
  </p>
  <p>
    <label><%= l(:dym_start_search_when_label)%></label>
    <%= select_tag 'settings[start_search_when]', options_for_select({
                l(:dym_leaving_field) => "0",
                l(:dym_while_typing) => "1"
                }, @settings['start_search_when'])
    %>
  </p>
</fieldset>
<script type='text/javascript'>
  $('#select_lang_note').hide();
  get_info();

  $('#settings_search_method').change(function() {
    get_info();
  });

  $('#settings_search_language').change(function() {
    $('#select_lang_note').show();
  });

  function get_info() {
    switch( $('#settings_search_method').val() ) {
      case "0":
          $('#ts_info').hide();
          $('#es_info').hide();
          $('#sql_info').show();
          $('#elastic_lang').hide();
          break;
      case "1":
          $('#sql_info').hide();
          $('#es_info').hide();
          $('#ts_info').show();
          $('#elastic_lang').hide();
          break;
      case "2":
          $('#sql_info').hide();
          $('#ts_info').hide();
          $('#es_info').show();
          $('#elastic_lang').show();
          break;
    }
  }
</script>